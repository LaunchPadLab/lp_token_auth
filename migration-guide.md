# Migration Guide
*Note: this guide assumes you are upgrading from LP Token Auth from v1 to v2.*

The purpose of this update is to increase the security of our JWT payloads by using JWE.

This version change will end all user sessions. This will requre users to sign in upon implementing the changes. All other features of previous authentication, such as duration are not affected. Aside from re-signing in, users will not be affected.

This version contains the following breaking changes:

1. Includes the [jwe](https://github.com/jwt/ruby-jwe) gem. This will require a `bundle update` to install this gem.

2. Requires 1 new environment variable and an optional environment variable to specify the encryption.
   `JWE_PRIVATE_KEY` contains an RSA key.
   `JWE_ENCRYPTION` is optional and specifies the encryption used. The default encryption is `A256GCM`.

The RSA key is generated by running `rake generate_rsa. This rake task will output a formatted RSA key to your console.

The formatted RSA key is a string on a single line with newline characters (\n) at the end of each line.

Common Pitfalls in Copy and Pasting RSA Keys

1.

2.

3.